---
layout: post
title: "C++ 동작 과정 & 메모리 동적 할당"
date: 2020-10-24 13:00:59
author: mollangzzang
categories: TIL
tags: TIL C++
cover: "/assets/TIL.png"
---

## C++ 실행 파일 생성 과정

1. 소스 파일 작성

2. 선행 처리기(preprocessor)에 의한 선행처리

> 선행처리란, 소스파일 중에서 선행처리 문자(#) 으로 시작하는 선행처리 지시문의 처리작업 수행

선행 처리작업은 선행처리기에 의해 처리되며, 선행처리기는 코드를 생성하는 것이 아닌 컴파일하기 전 컴파일러가 작업하기 좋도록 **소스를 재구성해주는 역할**

3. 컴파일러(compiler)에 의한 컴파일

> 소스파일을 컴퓨터가 알아볼 수 있는 기계어로 변환시키는 과정

컴파일은 C/C++ 컴파일러 (gcc 나 vs 컴파일러 등)에 의해 수행되며, 컴파일이 끝나 기계어로 변환된 파일을 Object file이라고 한다.
이러한 오브젝트 파일의 확장자는 `.o` 나 `.obj`가 된다.

4. 링커 (linker)에 의한 링크

컴파일러에 의해 생성된 오브젝트 파일은 운영체제와의 인터페이스를 담당하는 시동코드(start-up code)를 가지고 있지 않다.
또한 C++ 프로그램에서 사용하는 표준 라이브러리 파일도 가지고 있지 않다. 하나 이상의 **obj 파일과 라이브러리 파일, 시동코드 등을 합쳐 하나의 파일로 만드는 작업**을 **링크(link)**라고 한다.

링크가 끝나면 하나의 실행파일이나 라이브러리 파일이 생성된다. 이처럼 소스파일을 작성하여 최종적으로 링크를 통해 하나의 실행 파일로 만드는 것을 분할 컴파일이라고 한다.

5. 실행파일 생성

소스 파일은 선행처리기, 컴파일러 그리고 링커에 의해 위와 같은 과정을 거쳐 실행파일 `.exe`로 변환된다.

## 메모리 동적 할당

**데이터 영역**과 **스택 영역**에 할당되는 메모리의 크기는 **컴파일 타임**에 결정된다.

**힙 영역**의 크기는 프로그램이 실행되는 도중인 **런 타임**에 사용자가 결정하게 된다.

**런 타임에 메모리를 할당**받는 것을 **메모리의 동적 할당**이라고 한다.

`malloc` 과 같은 방식으로 선언 할 수도 있지만, `new` 키워드를 통해 생성할 수 있다.

### Ref.

http://tcpschool.com/cpp/cpp_intro_programming
